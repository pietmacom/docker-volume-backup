version: "3"

services:

  dashboard:
    image: grafana/grafana
    ports:
      - "3300:3000"
    volumes:
      - grafana-data:/var/lib/grafana

  backup:
    build: ../..
    environment:
      BACKUP_CRON_EXPRESSION: "0 0 * * *"
      ROTATE_BACKUPS: "dry-run" # You can test your configuration beforehand by peforming a "dry-run". See container logs for information on the dry-run.
    volumes:
      - grafana-data:/backup/grafana-data:ro
      - ./backups:/archive
      - .rotate-backups.ini:/config/.rotate-backups.ini # Providing an external .rotate-backups.ini file is optional. We provide a default configuration for you.

volumes:
  grafana-data:
